/*
Только для
zayavka.wTypeDoc = coWdocType_ZayavZarList
*/
DataStream ZayavZarList_DTS
  (
    [Date_Rep]  Cur_Date;
    [User_Name] UserName;
    [org_name] sGetTune('MYORG');
    [org_nameFull] sGetattr(coKatOrg,coGetTune('MYORG'),'Полное наименование');
    [org_Addr] if(getfirst katOrg where ((coGetTune('MYORG') == katorg.nrec)) = tsOK, KatOrg.Addr,'' );


    dataset dsZayavZarList
    (
      // дата заявления
      [DocDate] zayavka.DocDate;
      [NoDoc] zayavka.NoDoc;
      [SystemPitanie] SystemPitanie;
      [limitcategory] limitcategory;

      // ФИО гл.бухгалтера в дательном падеже
      [glb_fio_dp] iOdecl.FIODeclension(coGetTune('MAINBUH'),sGetTune('MAINBUH'), 3); //_ee.PersonsFIO(coGetTune('MAINBUH'));
//      [glb_fio_dp] iGP_Odecl.My_Sclonenie(sGetTune('MAINBUH'),23,coGetTune('MAINBUH'));
      // ФИО работника в именительном падеж              p
      [emp_fio_ip] PersonsFio;
      // должность
      [emp_post]   _ee.CurPostName(Pers.nRec);
      // подразделение
      [emp_podr]   podr.code;
      [emp_podr_name]   podr.name;
      // паспортные данные
      [passport]   _ee.GivenPassportName(Pers.PasspRus);
      [emp_phone]  zayavka.phone;
      [emp_email]  zayavka.email;
    );
  )

  HandleEvent DataSet dsZayavZarList
    cmPreProcess:
    {
      StartNewVisual(vtRotateVisual,
        vfTimer + vfBreak + vfConfirm, 'Печать отчета', 0);
    }

    cmOnProcess:
    {

    }

    cmPostProcess:
    {
      StopVisual('', 0);
    }
  end;

end; //dataStream
