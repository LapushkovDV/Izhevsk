/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 2000,3000 корпорация ГАЛАКТИКА                    ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Система       : Бухгалтерский контур                                      ║
 ║ Версия        : 5.8                                                       ║
 ║ Назначение    : Макроопределения для высветки КАУ, выбора КАУ             ║
 ║ Ответственный : Ларин Михаил Николаевич                                   ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/

#ifndef _ShowKau_Vpp_Included
#define _ShowKau_Vpp_Included

!-------------------------------------------------------------------------------
! Высветка
!-------------------------------------------------------------------------------
// Получить наименование КАУ
#declare ShowKau(wKau,cKau)
  ShowKau(#wKau,#cKau)
#end

// Получить строковый код КАУ (string(NRec) для системных и StrKod для пользовательских)
#declare ShowKau2(wKau,cKau)
  if (GetAnyKAU(cgAkSimple, #wKau, #cKau), GivenAnName(cgAnStrKod), '')
#end

// Получить наименование по номеру (Num см. cgAnXXXXXX из KauConst.inc)
#declare ShowKauNum(wKau,cKau,Num)
  if (GetAnyKAU(cgAkSimple, #wKau, #cKau), GivenAnName(#Num), '')
#end

#declare ShowKauAk(Ak,wKau,cKau)
  ShowKauAk(#Ak,#wKau,#cKau)
#end

// Отображение КАУ (3-х или 6-ти) в различных строчках
#declare ShowKauStrings(iTable,wKauArray=TblOs,cKauArray=KauOs)
  if (GetAnyKau(cgAkSimple,#iTable.#wKauArray[1],#iTable.#cKauArray[1]),GivenAnName(cgAnName),''),
  if (GetAnyKau(cgAkSimple,#iTable.#wKauArray[2],#iTable.#cKauArray[2]),GivenAnName(cgAnName),''),
  if (GetAnyKau(cgAkSimple,#iTable.#wKauArray[3],#iTable.#cKauArray[3]),GivenAnName(cgAnName),''),
  if (GetAnyKau(cgAkSimple,#iTable.#wKauArray[4],#iTable.#cKauArray[4]),GivenAnName(cgAnName),''),
  if (GetAnyKau(cgAkSimple,#iTable.#wKauArray[5],#iTable.#cKauArray[5]),GivenAnName(cgAnName),''),
  if (GetAnyKau(cgAkSimple,#iTable.#wKauArray[6],#iTable.#cKauArray[6]),GivenAnName(cgAnName),''),
#end

// Получить строковое наименование сразу 3-х (6-ти) КАУ
#declare ShowKauArray(wKauArray, cKauArray)
  ShowKauArray(#wKauArray, #cKauArray)
#end

  #declare ShowSchetBU(Sch, Sub, wKau, cKau)
    iShowSchet26.ShowSchetBU(#Sch,#Sub,#wKau,#cKau)
  #end

  #declare ShowKauArrayBU(wKau, cKau)
    iShowSchet26.ShowKauArrayBU(#wKau,#cKau)
  #end

  #declare __GetSchet(Sch, Sub, wKau, cKau)
    iShowSchet26.GetSchet(#Sch,#Sub,#wKau,#cKau)
  #end

#declare __GetSub(Sub)
  iShowSchet26.GetSub(#Sub)
#end
!-------------------------------------------------------------------------------
! Выбор
!-------------------------------------------------------------------------------

// Одиночный выбор значения КАУ
// #include GetKau.vih
// #include GetKau.var
#declare GetCodeKau_Single(wKau,cKau)
  if (iGetKau.GetCodeKau(cgiPick,#wKau,#cKau) <> 0)
    set #cKau := #cKau;
#end

// Вызвать Public функцию выбора всех КАУ
  #declare PickKauBuh(wIntMode,PickNum,iTable,sSch=SchetO,sSub=SubOsSch,wKauArray=TblOs,cKauArray=KauOs)
    iXGetKau.PickKauBuh(#wIntMode, #PickNum,
                        #iTable.#sSch, #iTable.#sSub,
                        #iTable.#wKauArray,
                        #iTable.#cKauArray
                        )
  #end

// Вызвать Public функцию построения подразделения
  #declare GetPodrToPersons(iTable,wKauArray=TblOs,cKauArray=KauOs,cPodr=KodSPO)
    iXGetKau.GetPodrToPersons(#iTable.#wKauArray,
                              #iTable.#cKauArray,
                              #iTable.#cPodr)
  #end

// Вызвать Public функцию для проверки заполнения аналитики
  #declare CheckAnalitikByTune(iTable,sSch=SchetO,sSub=SubOsSch,cKauArray=KauOs)
    iXGetKau.CheckAnalitikByTune(#iTable.#sSch, #iTable.#sSub,
                                 #iTable.#cKauArray)
  #end

!-------------------------------------------------------------------------------
! Обнуление
!-------------------------------------------------------------------------------
#declare NullingKauFields(iTable,wKauArray=TblOs,cKauArray=KauOs)
  #iTable.#wKauArray[1] := 0;
  #iTable.#wKauArray[2] := 0;
  #iTable.#wKauArray[3] := 0;
  #iTable.#wKauArray[4] := 0;
  #iTable.#wKauArray[5] := 0;
  #iTable.#wKauArray[6] := 0;
  #iTable.#cKauArray[1] := SetDefKodeKau;
  #iTable.#cKauArray[2] := SetDefKodeKau;
  #iTable.#cKauArray[3] := SetDefKodeKau;
  #iTable.#cKauArray[4] := SetDefKodeKau;
  #iTable.#cKauArray[5] := SetDefKodeKau;
  #iTable.#cKauArray[6] := SetDefKodeKau;
#end
!-------------------------------------------------------------------------------
#declare NullingKauNum(iTable,mKauArray=mKau)
  #iTable.#mKauArray[1]  := 0;
  #iTable.#mKauArray[2]  := 0;
  #iTable.#mKauArray[3]  := 0;
  #iTable.#mKauArray[4]  := 0;
  #iTable.#mKauArray[5]  := 0;
  #iTable.#mKauArray[6]  := 0;
#end
!-------------------------------------------------------------------------------
// Получить наименование КАУ для печати
#declare ShowKauPrn(wKau,cKau,dDate)
  ShowKauPrn(#wKau,#cKau,#dDate)
#end
!-------------------------------------------------------------------------------
// Получить строковое наименование всех КАУ для печати
#declare ShowKauArrayPrn(wKauArray, cKauArray, dDate)
    ShowKauArrayPrn(#wKauArray,#cKauArray, #dDate)
#end
!-------------------------------------------------------------------------------
// Получить строковое наименование КАУ для печати с проверкой на существование аналитики
#declare ShowKauAkPrn(Ak,wKau,cKau, dDate)
  if (GetAnyKau(#Ak, #wKau, #cKau), if(#wKau = cgKau_KatOrg and #cKau <> 0, ShowKauPrn(#wKau,#cKau,#dDate),GivenAnName(cgAnName)), '')
#end
!-------------------------------------------------------------------------------
#end
